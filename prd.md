# 贵金属汇率行情App PRD

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档名称 | 贵金属汇率行情App PRD |
| 文档版本 | V1.0 |
| 文档作者 | Claude PM |
| 创建日期 | 2025-12-25 |
| 最后更新 | 2025-12-25 |
| 文档状态 | 草稿 |
| 项目优先级 | P0 |

### 更新记录

| 版本 | 日期 | 作者 | 更新内容 |
|------|------|------|----------|
| V1.0 | 2025-12-25 | Claude PM | 初稿，包含核心功能页面设计 |

---

## 1. 需求概述

### 1.1 需求背景

**业务背景**

随着全球经济波动加剧，贵金属和外汇市场成为投资者关注的焦点。黄金、白银作为避险资产，以及主要货币的汇率变化，都是用户日常关注的重要金融信息。现有市场上的金融行情App大多功能繁杂、操作复杂，缺乏社交互动属性，用户难以获得实时的市场情绪反馈。

**用户场景**

- 投资者需要实时查看贵金属和汇率行情，做出投资决策
- 用户希望在查看价格时能看到其他人的评价和观点
- 用户需要便捷的货币兑换计算工具
- 用户希望与其他投资者交流讨论市场走势

**需求来源**

- 市场调研发现用户对行情+社交的需求
- 竞品分析显示差异化机会
- 移动端金融信息获取需求增长

### 1.2 产品目标

**用户目标**

- 快速获取黄金、白银、主要货币的实时行情
- 便捷进行货币兑换计算
- 参与行情讨论，获取他人观点
- 记录自己对某一时刻价格的看法

**商业目标**

- 构建金融社区，提升用户粘性
- 通过DAU和用户留存建立商业价值基础
- 为后续增值服务（如付费资讯、VIP会员）奠定用户基础

**目标用户**

| 用户类型 | 特征描述 | 占比 |
|---------|---------|------|
| 投资小白 | 对贵金属/外汇感兴趣，希望入门学习 | 40% |
| 业余投资者 | 有一定投资经验，定期关注行情 | 35% |
| 专业投资者 | 频繁交易，需要实时数据和深度分析 | 15% |
| 从业人员 | 金融行业相关人员，获取市场动态 | 10% |

### 1.3 产品范围

**本期范围（MVP）**

1. ✅ 首页 - 行情概览卡片网格
2. ✅ 行情页 - 黄金/白银详细行情列表
3. ✅ 汇率页 - 实时汇率+货币兑换计算器
4. ✅ 详情页 - K线图表+价格评论
5. ✅ 讨论区 - 热门话题榜+品种关注榜
6. ✅ 个人中心 - 用户资料+账号管理

**不在范围内**

- 实际交易功能
- 资产组合管理
- 付费会员体系
- 推送通知系统（后续版本）
- AI智能分析（后续版本，首页AI图标预留入口）

**依赖条件**

- 实时行情数据API接入
- 用户认证系统
- 评论内容审核系统
- K线图表组件库

**技术栈选型**

| 端 | 技术栈 | 说明 |
|---|-------|------|
| 移动端 | Flutter | 跨平台开发，同时支持iOS和Android |
| 后端 | Python FastAPI | 高性能异步API框架 |
| 数据库 | PostgreSQL + Redis | 主数据库 + 缓存/实时数据 |
| 实时通信 | WebSocket | 行情实时推送 |

---

## 2. 市场与用户分析

### 2.1 市场分析

**市场趋势**

- 移动端金融信息获取已成为主流
- 金融产品社交化趋势明显
- 贵金属投资热度持续上升
- 汇率波动频繁，用户关注度提高

### 2.2 竞品分析

| 竞品名称 | 核心功能 | 优势 | 劣势 | 差异化点 |
|---------|---------|------|------|---------|
| 英为财情 | 全品种行情+资讯 | 数据全面、专业 | 界面复杂、社交弱 | 专业深度 |
| 金荣中国App | 贵金属行情+交易 | 支持交易、实时数据 | 偏重交易、门槛高 | 交易导向 |
| 掌上黄金 | 黄金专项行情 | 专注黄金、简洁 | 品种单一、无社交 | 专一品种 |

**我们的差异化优势**

- 行情+社交深度结合
- 独创"评论锚定价格"机制
- 界面简洁、上手门槛低
- 社区氛围促进用户粘性

### 2.3 用户研究

**用户痛点**

1. **信息过载**：现有App功能繁杂，新手难以快速获取关键信息
2. **缺乏互动**：看行情时无法得知市场情绪和他人观点
3. **评论缺乏语境**：传统评论无法关联当时的价格，回顾时失去参考价值
4. **计算不便**：需要单独打开计算器进行汇率换算

---

## 3. 功能架构

### 3.1 产品架构图

```
┌─────────────────────────────────────────────────────────────┐
│                     贵金属汇率行情App                         │
├───────────┬───────────┬───────────┬───────────┬────────────┤
│   首页    │   行情    │   汇率    │  讨论区   │  个人中心   │
├───────────┼───────────┼───────────┼───────────┼────────────┤
│ · 搜索栏  │ · 黄金    │ · 汇率展示│ · 话题榜  │ · 用户资料 │
│ · AI入口  │ · 白银    │ · 计算器  │ · 关注榜  │ · 账号绑定 │
│ · 行情卡片│ · 分类导航│ · 货币列表│ · 点赞榜  │ · 偏好设置 │
│           │ · 详情入口│           │           │ · 语言切换 │
└───────────┴───────────┴───────────┴───────────┴────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        详情页（通用）                        │
├─────────────────────────────────────────────────────────────┤
│ · K线图表（分时/日K/周K/月K）                                │
│ · 实时价格信息                                               │
│ · 价格评论区（带价格锚定）                                   │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 导航结构

底部Tab导航（5个Tab）：
- 首页（Home）
- 行情（Market）
- 汇率（Exchange）
- 讨论区（Community）
- 我的（Profile）

---

## 4. 核心功能详细说明

### 4.0 交易品种数据结构

#### 4.0.1 支持的交易市场与品种

**上海黄金交易所 (SGE)**

| 品种类型 | 合约名称 | 代码 | 说明 |
|---------|---------|------|------|
| 黄金 | 现货实盘合约 | Au99.99 | 实物交割，纯度不低于99.99% |
| 黄金 | 现货实盘合约 | Au99.95 | 实物交割，纯度不低于99.95% |
| 黄金 | 现货实盘合约（金条100g）| Au100g | 100克规格金条 |
| 黄金 | 延期交收合约 | Au(T+D) | 保证金交易，带杠杆，可双向操作 |
| 黄金 | 迷你黄金延期交收合约 | mAu(T+D) | 降低交易单位的T+D合约 |
| 黄金 | 集中定价合约（上海金）| SHAU | 提供人民币基准价 |
| 白银 | 延期交收合约 | Ag(T+D) | 保证金交易，带杠杆 |
| 白银 | 集中定价合约（上海银）| SHAG | 提供人民币基准价 |

**国际现货市场 (LBMA)**

| 品种类型 | 合约名称 | 代码 | 说明 |
|---------|---------|------|------|
| 黄金 | 现货黄金（伦敦金）| XAU / XAUUSD | 全球现货黄金定价基准，场外交易 |
| 白银 | 现货白银（伦敦银）| XAG / XAGUSD | 全球现货白银定价基准，场外交易 |
| 铂金 | 现货铂金 | XPT | 铂金现货 |
| 钯金 | 现货钯金 | XPD | 钯金现货 |

**纽约商品交易所 (COMEX)**

| 品种类型 | 合约名称 | 代码 | 说明 |
|---------|---------|------|------|
| 黄金 | 黄金期货 | GC | 全球最活跃的黄金期货合约 |
| 白银 | 白银期货 | SI | 全球白银期货基准 |

**主要货币 (外汇)**

| 货币名称 | ISO代码 | 常见表示 | 说明 |
|---------|---------|---------|------|
| 美元 | USD | USD (美元) | 国际主要储备货币 |
| 欧元 | EUR | EUR/USD (欧元/美元) | 欧盟官方货币，外汇市场交易量最大的货币之一 |
| 人民币 | CNY | USD/CNY (美元/人民币) | 中国法定货币，国际金融交易标准代码 |
| 英镑 | GBP | GBP/USD (英镑/美元) | 英国法定货币 |
| 日元 | JPY | USD/JPY (美元/日元) | 日本法定货币 |
| 澳元 | AUD | AUD/USD (澳元/美元) | 澳大利亚法定货币 |
| 加元 | CAD | USD/CAD (美元/加元) | 加拿大法定货币 |
| 瑞士法郎 | CHF | USD/CHF (美元/瑞郎) | 瑞士法定货币 |
| 港币 | HKD | USD/HKD (美元/港币) | 香港法定货币 |

#### 4.0.2 品种数据模型

```python
# FastAPI 后端数据模型示例

class Market(str, Enum):
    SGE = "SGE"        # 上海黄金交易所
    LBMA = "LBMA"      # 伦敦金银市场协会
    COMEX = "COMEX"    # 纽约商品交易所
    FOREX = "FOREX"    # 外汇市场

class SymbolType(str, Enum):
    GOLD = "gold"      # 黄金
    SILVER = "silver"  # 白银
    PLATINUM = "platinum"  # 铂金
    PALLADIUM = "palladium"  # 钯金
    CURRENCY = "currency"  # 货币

class Symbol(BaseModel):
    code: str              # 品种代码，如 "XAUUSD"
    name_cn: str           # 中文名称，如 "伦敦金"
    name_en: str           # 英文名称，如 "Spot Gold"
    market: Market         # 所属市场
    symbol_type: SymbolType  # 品种类型
    base_currency: str     # 基础货币
    quote_currency: str    # 报价货币
    decimal_places: int    # 小数位数
    unit: str              # 单位，如 "盎司"、"克"
    description: str       # 品种说明

class Quote(BaseModel):
    symbol_code: str       # 品种代码
    price: Decimal         # 当前价格
    change: Decimal        # 涨跌额
    change_percent: Decimal  # 涨跌幅
    high: Decimal          # 最高价
    low: Decimal           # 最低价
    open: Decimal          # 开盘价
    prev_close: Decimal    # 昨收价
    volume: Optional[int]  # 成交量
    timestamp: datetime    # 时间戳
```

#### 4.0.3 行情分类导航结构

```
行情页导航结构：
├── 黄金
│   ├── 国际黄金
│   │   ├── XAU/USD (伦敦金)
│   │   └── GC (COMEX黄金期货)
│   └── 国内黄金
│       ├── Au99.99
│       ├── Au99.95
│       ├── Au100g
│       ├── Au(T+D)
│       ├── mAu(T+D)
│       └── SHAU (上海金)
├── 白银
│   ├── 国际白银
│   │   ├── XAG/USD (伦敦银)
│   │   └── SI (COMEX白银期货)
│   └── 国内白银
│       ├── Ag(T+D)
│       └── SHAG (上海银)
└── 其他贵金属（可选扩展）
    ├── XPT (铂金)
    └── XPD (钯金)
```

### 4.1 首页

#### 4.1.1 功能描述

首页作为App的入口，提供全局行情概览，让用户快速获取黄金、白银、主要汇率品种的实时信息。

#### 4.1.2 页面布局

```
┌────────────────────────────────────┐
│  ┌────────────────────────┐ [AI]  │  ← 搜索栏 + AI图标
│  │      搜索品种...       │       │
│  └────────────────────────┘       │
├────────────────────────────────────┤
│  ┌───────────┐  ┌───────────┐     │
│  │  黄金Au   │  │  白银Ag   │     │  ← 行情卡片网格
│  │  2658.50  │  │  30.25    │     │     (每行2个)
│  │  ▲ +1.2%  │  │  ▼ -0.8%  │     │
│  └───────────┘  └───────────┘     │
│  ┌───────────┐  ┌───────────┐     │
│  │  USD/CNY  │  │  EUR/CNY  │     │
│  │  7.2456   │  │  7.8923   │     │
│  │  ▲ +0.15% │  │  ▼ -0.23% │     │
│  └───────────┘  └───────────┘     │
│  ┌───────────┐  ┌───────────┐     │
│  │  GBP/CNY  │  │  JPY/CNY  │     │
│  │  9.1234   │  │  0.0486   │     │
│  │  ▲ +0.08% │  │  ▲ +0.12% │     │
│  └───────────┘  └───────────┘     │
│          ...更多品种...            │
└────────────────────────────────────┘
```

#### 4.1.3 功能规则

**搜索栏**
- 位置：页面顶部固定
- 功能：支持品种名称、代码搜索
- 右侧AI图标：作为未来AI功能入口预留
- 点击搜索栏展开搜索页面，支持实时联想

**行情卡片**

| 元素 | 说明 |
|-----|------|
| 品种名称 | 中文名称 + 代码（如：黄金 Au） |
| 当前价格 | 实时价格，精确到小数点后2-4位 |
| 涨跌幅 | 较昨收涨跌百分比 |
| 涨跌标识 | 红色向上箭头（涨）/ 绿色向下箭头（跌）|
| 卡片样式 | 圆角矩形，轻微阴影，每行2个 |

**涨跌颜色规则**
- 默认：红涨绿跌（中国习惯）
- 可在个人中心切换为：绿涨红跌（国际习惯）

#### 4.1.4 交互说明

| 操作 | 响应 |
|-----|------|
| 点击搜索栏 | 进入搜索页面 |
| 点击AI图标 | 显示"功能即将上线"提示 |
| 点击行情卡片 | 进入该品种详情页 |
| 下拉页面 | 刷新行情数据 |

#### 4.1.5 验收标准

- [ ] 搜索栏固定在顶部，AI图标位于右侧
- [ ] 行情卡片网格布局，每行2个
- [ ] 价格实时更新（间隔≤5秒）
- [ ] 涨跌颜色正确显示
- [ ] 点击卡片可正确跳转详情页

---

### 4.2 行情页

#### 4.2.1 功能描述

行情页提供黄金、白银两大类贵金属的详细行情列表，支持分类导航切换，用户可查看更多品种的详细信息。

#### 4.2.2 页面布局

```
┌────────────────────────────────────┐
│  [ 黄金 ]    [ 白银 ]              │  ← 可滑动分类导航Tab
├────────────────────────────────────┤
│  ┌──────────────────────────────┐  │
│  │  伦敦金 (XAU/USD)            │  │
│  │  现价: 2658.50  ▲ +28.30    │  │
│  │  涨幅: +1.08%                │  │
│  │  最高: 2665.20  最低: 2630.00│  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │  Au9999                      │  │
│  │  现价: 614.50   ▲ +3.20     │  │
│  │  涨幅: +0.52%                │  │
│  │  最高: 616.80   最低: 610.00 │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │  Au99.95                     │  │
│  │  现价: 613.80   ▲ +2.90     │  │
│  │  涨幅: +0.47%                │  │
│  │  最高: 615.50   最低: 609.50 │  │
│  └──────────────────────────────┘  │
│           ↓ 下拉加载更多           │
└────────────────────────────────────┘
```

#### 4.2.3 功能规则

**分类导航**

| 分类 | 包含品种 |
|-----|---------|
| 黄金 | 伦敦金(XAU/USD)、Au9999、Au99.95、Au T+D、黄金期货等 |
| 白银 | 伦敦银(XAG/USD)、Ag9999、Ag T+D、白银期货等 |

**行情列表项**

| 字段 | 说明 |
|-----|------|
| 品种名称 | 中文名称 + 英文代码 |
| 现价 | 当前实时价格 |
| 涨跌额 | 较昨收价格变化值 |
| 涨跌幅 | 较昨收涨跌百分比 |
| 最高/最低 | 当日最高价和最低价 |

#### 4.2.4 交互说明

| 操作 | 响应 |
|-----|------|
| 左右滑动导航Tab | 切换黄金/白银分类 |
| 点击导航Tab | 切换到对应分类 |
| 点击行情列表项 | 进入该品种详情页 |
| 下拉列表 | 加载更多品种 |
| 下拉刷新 | 刷新当前分类数据 |

#### 4.2.5 验收标准

- [ ] 分类导航Tab可滑动切换
- [ ] 黄金/白银分类数据正确展示
- [ ] 行情列表支持下拉加载更多
- [ ] 点击列表项正确跳转详情页
- [ ] 数据实时更新

---

### 4.3 汇率页

#### 4.3.1 功能描述

汇率页提供主要货币对的实时汇率展示，并集成双向货币兑换计算器，方便用户快速进行货币换算。

#### 4.3.2 页面布局

```
┌────────────────────────────────────┐
│           汇率换算计算器            │
├────────────────────────────────────┤
│  ┌─────────┐    ┌─────────────┐   │
│  │  USD ▼  │    │    100.00   │   │  ← 输入货币和金额
│  └─────────┘    └─────────────┘   │
│              ⇅ (切换按钮)          │
│  ┌─────────┐    ┌─────────────┐   │
│  │  CNY ▼  │    │    724.56   │   │  ← 输出货币和结果
│  └─────────┘    └─────────────┘   │
├────────────────────────────────────┤
│         主要货币汇率（基于1美元）    │
├────────────────────────────────────┤
│  ┌──────────────────────────────┐  │
│  │  🇪🇺 EUR 欧元                 │  │
│  │  1 USD = 0.9234 EUR          │  │
│  │  ▼ -0.15%                    │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │  🇨🇳 CNY 人民币               │  │
│  │  1 USD = 7.2456 CNY          │  │
│  │  ▲ +0.08%                    │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │  🇬🇧 GBP 英镑                 │  │
│  │  1 USD = 0.7892 GBP          │  │
│  │  ▼ -0.12%                    │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │  🇯🇵 JPY 日元                 │  │
│  │  1 USD = 149.23 JPY          │  │
│  │  ▲ +0.25%                    │  │
│  └──────────────────────────────┘  │
│           ...更多货币...           │
└────────────────────────────────────┘
```

#### 4.3.3 功能规则

**货币兑换计算器**

| 元素 | 说明 |
|-----|------|
| 源货币选择器 | 下拉选择源货币，默认USD |
| 源金额输入框 | 支持数字输入，支持小数 |
| 切换按钮 | 一键交换源货币和目标货币 |
| 目标货币选择器 | 下拉选择目标货币，默认CNY |
| 目标金额显示 | 实时计算并显示换算结果 |

**计算规则**
- 实时获取汇率进行计算
- 结果保留2位小数
- 输入变化时实时更新结果
- 支持双向计算

**货币列表**

| 货币代码 | 货币名称 | 国旗 |
|---------|---------|------|
| EUR | 欧元 | 🇪🇺 |
| CNY | 人民币 | 🇨🇳 |
| GBP | 英镑 | 🇬🇧 |
| JPY | 日元 | 🇯🇵 |
| AUD | 澳元 | 🇦🇺 |
| CAD | 加元 | 🇨🇦 |
| CHF | 瑞郎 | 🇨🇭 |
| HKD | 港币 | 🇭🇰 |
| ... | 更多 | ... |

#### 4.3.4 交互说明

| 操作 | 响应 |
|-----|------|
| 点击货币选择器 | 弹出货币选择列表 |
| 输入金额 | 实时计算换算结果 |
| 点击切换按钮 | 交换源货币和目标货币 |
| 点击货币列表项 | 进入该货币对的详情页 |
| 下拉页面 | 刷新汇率数据 |

#### 4.3.5 验收标准

- [ ] 计算器支持双向货币选择
- [ ] 金额输入实时计算结果
- [ ] 切换按钮正确交换货币
- [ ] 货币列表显示国旗、名称、汇率、涨跌幅
- [ ] 汇率数据实时更新

---

### 4.4 详情页（核心功能）

#### 4.4.1 功能描述

详情页是所有品种（黄金、白银、货币）的通用详情展示页面，包含K线图表和独特的"价格锚定评论区"功能。这是本产品的核心差异化功能。

#### 4.4.2 页面布局

```
┌────────────────────────────────────┐
│  ← 返回    伦敦金 XAU/USD    ☆     │  ← 顶部导航栏
├────────────────────────────────────┤
│         2658.50                    │
│      ▲ +28.30 (+1.08%)            │  ← 实时价格区
│    最高: 2665.20  最低: 2630.00    │
├────────────────────────────────────┤
│  [分时] [日K] [周K] [月K]          │  ← K线周期切换
├────────────────────────────────────┤
│                                    │
│         📈 K线图表区域             │  ← K线图表
│                                    │
│                                    │
├────────────────────────────────────┤
│  评论区 (156条)              发布 + │  ← 评论区标题
├────────────────────────────────────┤
│  ┌──────────────────────────────┐  │
│  │ 👤 用户A       2小时前       │  │
│  │ ┌────────────────────────┐   │  │
│  │ │ 💰 评论时价格: 2650.30  │   │  │  ← 价格锚定标签
│  │ └────────────────────────┘   │  │
│  │ 感觉要突破2660了，准备      │  │
│  │ 加仓！                       │  │
│  │                              │  │
│  │ ❤️ 128  💬 23  ↩️ 回复       │  │  ← 互动按钮
│  │ ├─ 👤 用户B: 我也这么觉得   │  │  ← 回复（折叠）
│  │ ├─ 👤 用户C: 小心回调       │  │
│  │ └─ 查看全部23条回复 >       │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │ 👤 用户D       5小时前       │  │
│  │ ┌────────────────────────┐   │  │
│  │ │ 💰 评论时价格: 2635.80  │   │  │
│  │ └────────────────────────┘   │  │
│  │ 今天波动不大，观望中...     │  │
│  │ ❤️ 56   💬 8   ↩️ 回复       │  │
│  └──────────────────────────────┘  │
└────────────────────────────────────┘
```

#### 4.4.3 核心功能：价格锚定评论系统

**功能设计理念**

当用户发布评论时，系统自动记录当时的实时价格，并在评论内容上方以特殊样式展示"评论时价格"标签。这让其他用户在阅读评论时能够理解评论者的市场语境，增强评论的参考价值。

**评论数据结构**

| 字段 | 类型 | 说明 |
|-----|------|------|
| comment_id | String | 评论唯一标识 |
| user_id | String | 评论用户ID |
| symbol | String | 品种代码 |
| content | String | 评论内容 |
| price_at_comment | Number | 评论时的实时价格 |
| timestamp | DateTime | 评论时间 |
| likes_count | Number | 点赞数 |
| replies_count | Number | 回复数 |
| parent_id | String | 父评论ID（如果是回复） |

**评论发布流程**

```
用户点击"发布"
      ↓
弹出评论输入框
      ↓
用户输入评论内容
      ↓
点击"发送"
      ↓
系统捕获当前实时价格
      ↓
创建评论记录（content + price_at_comment）
      ↓
发布成功，显示在评论列表
```

#### 4.4.4 评论区交互设计（参考小红书+X）

**评论列表布局（参考小红书）**

- 评论以卡片形式垂直排列
- 每条评论包含：头像、用户名、时间、价格标签、内容、互动栏
- 回复默认折叠显示，展示前2-3条
- 点击"查看全部X条回复"展开所有回复

**评论对话逻辑（参考X/Twitter）**

| 交互场景 | 行为描述 |
|---------|---------|
| 发布主评论 | 直接对当前价格发表观点 |
| 回复评论 | 点击"回复"按钮，进入回复模式 |
| 回复的回复 | 支持嵌套回复，形成对话线程 |
| @提及 | 回复时自动@被回复者 |
| 点赞 | 点击❤️图标，数量实时更新 |
| 查看对话 | 点击评论可展开完整对话线程 |

**回复展示规则**

```
主评论
├── 回复1（显示）
├── 回复2（显示）
├── 回复3（显示，如果≤3条）
└── "查看全部X条回复 >"（如果>3条）
```

#### 4.4.5 K线图表功能

**周期选项**

| 周期 | 说明 |
|-----|------|
| 分时 | 当日分时走势图 |
| 日K | 日K线图 |
| 周K | 周K线图 |
| 月K | 月K线图 |

**图表交互**

| 操作 | 响应 |
|-----|------|
| 左右滑动 | 查看历史K线 |
| 双指缩放 | 调整K线密度 |
| 长按 | 显示十字光标和详细数据 |
| 点击周期Tab | 切换K线周期 |

#### 4.4.6 交互说明

| 操作 | 响应 |
|-----|------|
| 点击返回 | 返回上一页 |
| 点击收藏 | 收藏/取消收藏该品种 |
| 点击"发布" | 弹出评论输入框 |
| 提交评论 | 捕获当前价格，发布评论 |
| 点击点赞 | 点赞数+1，按钮变红 |
| 点击回复 | 进入回复输入模式 |
| 点击评论 | 展开对话线程详情 |
| 下拉评论区 | 加载更多评论 |

#### 4.4.7 验收标准

- [ ] K线图表正常显示，支持4种周期切换
- [ ] K线支持滑动、缩放、长按交互
- [ ] 发布评论时自动记录当前价格
- [ ] 评论显示"评论时价格"标签
- [ ] 评论支持点赞、回复功能
- [ ] 回复支持嵌套对话
- [ ] 评论列表支持下拉加载更多

---

### 4.5 讨论区

#### 4.5.1 功能描述

讨论区是社区内容聚合页面，展示热门话题、热门品种关注榜和热门评价榜单，帮助用户发现有价值的讨论内容。

#### 4.5.2 页面布局

```
┌────────────────────────────────────┐
│  [话题榜] [关注榜] [点赞榜]         │  ← Tab切换
├────────────────────────────────────┤
│                                    │
│        === 话题榜Tab ===           │
│                                    │
│  🔥 实时讨论话题Top榜单             │
├────────────────────────────────────┤
│  1. #黄金突破2660#                 │
│     📊 讨论数: 2.3k  🔥 热度: 98   │
│                                    │
│  2. #美联储降息预期#               │
│     📊 讨论数: 1.8k  🔥 热度: 92   │
│                                    │
│  3. #人民币汇率走势#               │
│     📊 讨论数: 1.2k  🔥 热度: 85   │
│                                    │
│  ... 更多话题 ...                  │
├────────────────────────────────────┤
│                                    │
│        === 关注榜Tab ===           │
│                                    │
│  🏆 热门品种关注榜                  │
├────────────────────────────────────┤
│  1. 伦敦金 XAU/USD                 │
│     👁️ 关注: 58.2k  📝 评论: 12.5k│
│                                    │
│  2. 美元/人民币 USD/CNY            │
│     👁️ 关注: 45.6k  📝 评论: 8.9k │
│                                    │
│  3. 伦敦银 XAG/USD                 │
│     👁️ 关注: 32.1k  📝 评论: 6.2k │
│                                    │
│  ... 更多品种 ...                  │
├────────────────────────────────────┤
│                                    │
│        === 点赞榜Tab ===           │
│                                    │
│  👍 热门评价点赞榜                  │
├────────────────────────────────────┤
│  ┌──────────────────────────────┐  │
│  │ 👤 投资达人A                  │  │
│  │ 💰 评论时价格: 2650.30       │  │
│  │ "黄金长期看涨，短期注意..."   │  │
│  │ ❤️ 5.2k  💬 328              │  │
│  └──────────────────────────────┘  │
│  ┌──────────────────────────────┐  │
│  │ 👤 外汇分析师B                │  │
│  │ 💰 评论时价格: 7.2380        │  │
│  │ "人民币汇率稳定，不必恐慌..." │  │
│  │ ❤️ 4.8k  💬 256              │  │
│  └──────────────────────────────┘  │
└────────────────────────────────────┘
```

#### 4.5.3 功能规则

**话题榜**

| 字段 | 说明 |
|-----|------|
| 话题标签 | #话题名称# 格式 |
| 讨论数 | 包含该话题的评论数量 |
| 热度值 | 综合讨论数、参与人数、时效性计算 |
| 排序规则 | 按热度值降序排列 |

**关注榜**

| 字段 | 说明 |
|-----|------|
| 品种名称 | 品种中文名+代码 |
| 关注人数 | 收藏该品种的用户数 |
| 评论数 | 该品种详情页的评论总数 |
| 排序规则 | 按关注人数降序排列 |

**点赞榜**

| 字段 | 说明 |
|-----|------|
| 评论卡片 | 同详情页评论卡片样式 |
| 排序规则 | 按点赞数降序排列 |
| 时间范围 | 默认显示24小时内热门评论 |

#### 4.5.4 交互说明

| 操作 | 响应 |
|-----|------|
| 点击Tab | 切换榜单类型 |
| 点击话题 | 进入话题详情页（显示相关评论） |
| 点击品种 | 进入该品种详情页 |
| 点击评论卡片 | 进入评论所属品种的详情页 |
| 下拉列表 | 加载更多内容 |

#### 4.5.5 验收标准

- [ ] 三个Tab正确切换
- [ ] 话题榜显示热门话题和热度
- [ ] 关注榜显示品种关注和评论数据
- [ ] 点赞榜显示热门评论（含价格标签）
- [ ] 各榜单点击跳转正确

---

### 4.6 个人中心

#### 4.6.1 功能描述

个人中心是用户管理页面，提供用户资料修改、账号绑定、偏好设置等功能。需要登录后才能访问完整功能。

#### 4.6.2 页面布局

**未登录状态**

```
┌────────────────────────────────────┐
│                                    │
│           👤 点击登录              │
│                                    │
│   ┌─────────────────────────────┐  │
│   │    📱 手机号登录             │  │
│   └─────────────────────────────┘  │
│   ┌─────────────────────────────┐  │
│   │    🔵 Google登录            │  │
│   └─────────────────────────────┘  │
│   ┌─────────────────────────────┐  │
│   │    🍎 Apple登录             │  │
│   └─────────────────────────────┘  │
│                                    │
└────────────────────────────────────┘
```

**已登录状态**

```
┌────────────────────────────────────┐
│  ┌────┐                            │
│  │ 👤 │  用户昵称                  │  ← 用户信息卡片
│  └────┘  用户ID: 12345678          │
├────────────────────────────────────┤
│  个人资料                      >   │
├────────────────────────────────────┤
│  账号绑定                      >   │
├────────────────────────────────────┤
│  偏好设置                          │
│  ├─ 涨跌颜色    [红涨绿跌 ▼]      │  ← 下拉选择
│  └─ 语言        [简体中文 ▼]      │
├────────────────────────────────────┤
│  我的收藏                      >   │
├────────────────────────────────────┤
│  我的评论                      >   │
├────────────────────────────────────┤
│  关于我们                      >   │
├────────────────────────────────────┤
│  退出登录                          │
└────────────────────────────────────┘
```

#### 4.6.3 功能规则

**登录方式**

| 登录方式 | 说明 |
|---------|------|
| 手机号登录 | 支持短信验证码登录，作为默认登录方式 |
| Google登录 | OAuth第三方登录 |
| Apple登录 | Sign in with Apple |
| 微信绑定 | 绑定后可通过微信登录（非首次登录方式）|

**账号绑定管理**

| 绑定项 | 操作 |
|-------|------|
| 手机号 | 绑定/更换手机号 |
| Google | 绑定/解绑 |
| Apple | 绑定/解绑 |
| 微信 | 绑定/解绑 |

**偏好设置**

| 设置项 | 选项 |
|-------|------|
| 涨跌颜色 | 红涨绿跌（默认）/ 绿涨红跌 |
| 语言 | 简体中文 / 繁体中文 / English |

**语言选择时机**
- 新用户注册流程中可选择语言
- 已注册用户可在设置中随时切换

#### 4.6.4 个人资料修改

| 字段 | 可编辑 | 说明 |
|-----|-------|------|
| 头像 | ✅ | 支持从相册选择或拍照 |
| 昵称 | ✅ | 2-20个字符 |
| 简介 | ✅ | 最多100个字符 |
| 用户ID | ❌ | 系统自动生成，不可修改 |

#### 4.6.5 交互说明

| 操作 | 响应 |
|-----|------|
| 点击登录入口 | 进入登录页面 |
| 选择登录方式 | 执行对应登录流程 |
| 点击个人资料 | 进入资料编辑页面 |
| 点击账号绑定 | 进入账号绑定管理页面 |
| 切换涨跌颜色 | 全局涨跌颜色立即生效 |
| 切换语言 | 弹出确认框，确认后重启App生效 |
| 点击退出登录 | 弹出确认框，确认后退出 |

#### 4.6.6 验收标准

- [ ] 未登录状态显示登录入口
- [ ] 支持手机号、Google、Apple三种登录方式
- [ ] 支持微信绑定/解绑
- [ ] 个人资料可正常编辑保存
- [ ] 涨跌颜色切换全局生效
- [ ] 语言切换正确生效
- [ ] 退出登录正常工作

---

## 5. 非功能需求

### 5.1 性能要求

| 指标 | 要求 |
|-----|------|
| 首页加载时间 | ≤ 2秒 |
| 行情数据刷新间隔 | ≤ 5秒 |
| K线图渲染时间 | ≤ 1秒 |
| 评论加载时间 | ≤ 1秒（首屏20条）|
| API响应时间 | ≤ 500ms |

### 5.2 兼容性要求

| 平台 | 最低版本 |
|-----|---------|
| iOS | iOS 13.0+ |
| Android | Android 8.0+ (API 26) |

### 5.3 安全性要求

| 安全项 | 措施 |
|-------|------|
| 数据传输 | 全站HTTPS |
| 用户认证 | JWT Token机制 |
| 敏感数据 | 脱敏存储 |
| 评论审核 | 接入内容安全服务 |

### 5.4 可用性要求

| 指标 | 要求 |
|-----|------|
| 系统可用性 | ≥ 99.5% |
| 行情数据准确性 | 与数据源一致 |

---

## 6. 数据埋点

### 6.1 关键页面埋点

| 页面 | 事件名 | 触发时机 | 关键参数 |
|-----|-------|---------|---------|
| 首页 | home_view | 页面加载 | - |
| 首页 | card_click | 点击行情卡片 | symbol |
| 行情页 | market_view | 页面加载 | category |
| 汇率页 | exchange_view | 页面加载 | - |
| 汇率页 | calculator_use | 使用计算器 | from_currency, to_currency |
| 详情页 | detail_view | 页面加载 | symbol |
| 详情页 | kline_switch | 切换K线周期 | period |
| 详情页 | comment_post | 发布评论 | symbol, price_at_comment |
| 详情页 | comment_like | 点赞评论 | comment_id |
| 详情页 | comment_reply | 回复评论 | comment_id |
| 讨论区 | community_view | 页面加载 | tab_type |
| 个人中心 | profile_view | 页面加载 | is_logged_in |
| 登录 | login_attempt | 尝试登录 | login_type |
| 登录 | login_success | 登录成功 | login_type |

### 6.2 核心指标

**北极星指标**
- DAU（日活跃用户数）

**一级指标**
- 用户留存率（次日/7日/30日）
- 评论发布数
- 人均浏览品种数

**二级指标**
- 评论点赞率
- 评论回复率
- 计算器使用次数
- K线查看时长

---

## 7. 项目规划

### 7.1 里程碑计划

| 里程碑 | 交付物 | 预计完成时间 |
|--------|--------|-------------|
| PRD评审 | PRD文档定稿 | W1 |
| UI设计 | 全套UI设计稿 | W2-W3 |
| 技术方案 | 技术架构文档 | W3 |
| 开发完成 | 功能代码 | W4-W8 |
| 测试完成 | 测试报告 | W9-W10 |
| 上线发布 | App Store/Google Play | W11 |

### 7.2 版本规划

**V1.0（本期）**
- 核心功能：首页、行情、汇率、详情页、讨论区、个人中心
- 核心特性：价格锚定评论系统

**V1.1（计划）**
- AI智能分析入口
- 推送通知系统
- 评论话题标签功能

**V2.0（远期）**
- 付费会员体系
- 更多行情品种
- 社区互动增强

---

## 9. 技术架构设计

### 9.1 整体架构

```
┌─────────────────────────────────────────────────────────────────┐
│                        客户端 (Flutter)                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────────────┐ │
│  │ iOS App  │  │Android App│  │ 状态管理  │  │ WebSocket Client│ │
│  └──────────┘  └──────────┘  │ (Riverpod)│  │  (实时行情)     │ │
│                              └──────────┘  └──────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│                      API Gateway / Nginx                        │
│                   (负载均衡、SSL终止、限流)                       │
└─────────────────────────────────────────────────────────────────┘
                                    │
                    ┌───────────────┼───────────────┐
                    ▼               ▼               ▼
┌──────────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│   FastAPI 服务       │  │  WebSocket 服务  │  │   定时任务服务   │
│  ┌────────────────┐  │  │  (实时行情推送)  │  │  (Celery/APScheduler)│
│  │ 用户认证模块   │  │  │                 │  │  ┌─────────────┐ │
│  │ 行情查询模块   │  │  │                 │  │  │ 行情数据同步│ │
│  │ 评论社区模块   │  │  │                 │  │  │ 榜单计算    │ │
│  │ 计算器模块     │  │  │                 │  │  │ 数据清理    │ │
│  └────────────────┘  │  │                 │  │  └─────────────┘ │
└──────────────────────┘  └─────────────────┘  └─────────────────┘
            │                       │                   │
            └───────────────────────┼───────────────────┘
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│                          数据层                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐   │
│  │  PostgreSQL  │  │    Redis     │  │   第三方行情API       │   │
│  │  (主数据库)   │  │  (缓存/队列) │  │  (数据源接入)        │   │
│  └──────────────┘  └──────────────┘  └──────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

### 9.2 Flutter 客户端架构

#### 9.2.1 技术选型

| 组件 | 技术方案 | 说明 |
|-----|---------|------|
| 状态管理 | Riverpod | 响应式状态管理，支持依赖注入 |
| 网络请求 | Dio | HTTP客户端，支持拦截器 |
| 实时通信 | web_socket_channel | WebSocket连接 |
| K线图表 | fl_chart / k_chart | 专业金融图表组件 |
| 本地存储 | shared_preferences + Hive | 配置存储 + 结构化数据缓存 |
| 路由管理 | go_router | 声明式路由 |
| 国际化 | flutter_localizations + intl | 多语言支持 |

#### 9.2.2 项目结构

```
lib/
├── main.dart
├── app/
│   ├── app.dart                    # App入口
│   ├── routes/                     # 路由配置
│   └── theme/                      # 主题配置（含红涨绿跌切换）
├── core/
│   ├── constants/                  # 常量定义
│   ├── network/                    # 网络层
│   │   ├── api_client.dart         # Dio封装
│   │   ├── websocket_client.dart   # WebSocket封装
│   │   └── interceptors/           # 拦截器
│   ├── storage/                    # 本地存储
│   └── utils/                      # 工具类
├── features/
│   ├── home/                       # 首页模块
│   │   ├── data/                   # 数据层
│   │   ├── domain/                 # 领域层
│   │   └── presentation/           # 展示层
│   ├── market/                     # 行情模块
│   ├── exchange/                   # 汇率模块
│   ├── detail/                     # 详情页模块
│   │   ├── widgets/
│   │   │   ├── kline_chart.dart    # K线图组件
│   │   │   └── comment_section.dart # 评论区组件
│   │   └── ...
│   ├── community/                  # 讨论区模块
│   └── profile/                    # 个人中心模块
├── models/                         # 数据模型
│   ├── symbol.dart                 # 品种模型
│   ├── quote.dart                  # 行情模型
│   ├── comment.dart                # 评论模型
│   └── user.dart                   # 用户模型
├── providers/                      # Riverpod Providers
│   ├── quote_provider.dart         # 行情状态
│   ├── auth_provider.dart          # 认证状态
│   └── settings_provider.dart      # 设置状态
└── widgets/                        # 通用组件
    ├── quote_card.dart             # 行情卡片
    ├── comment_item.dart           # 评论项
    └── price_tag.dart              # 价格锚定标签
```

### 9.3 FastAPI 后端架构

#### 9.3.1 技术选型

| 组件 | 技术方案 | 说明 |
|-----|---------|------|
| Web框架 | FastAPI | 高性能异步框架，自动API文档 |
| ORM | SQLAlchemy 2.0 + asyncpg | 异步数据库操作 |
| 数据库 | PostgreSQL | 主数据库 |
| 缓存 | Redis | 行情缓存、会话管理、排行榜 |
| 任务队列 | Celery / APScheduler | 定时任务、异步任务 |
| 认证 | JWT + OAuth2 | 用户认证 |
| WebSocket | FastAPI WebSocket | 实时行情推送 |

#### 9.3.2 项目结构

```
backend/
├── app/
│   ├── main.py                     # FastAPI入口
│   ├── config.py                   # 配置管理
│   ├── database.py                 # 数据库连接
│   ├── api/
│   │   ├── v1/
│   │   │   ├── __init__.py
│   │   │   ├── auth.py             # 认证接口
│   │   │   ├── quotes.py           # 行情接口
│   │   │   ├── symbols.py          # 品种接口
│   │   │   ├── comments.py         # 评论接口
│   │   │   ├── exchange.py         # 汇率计算接口
│   │   │   ├── community.py        # 社区榜单接口
│   │   │   └── users.py            # 用户接口
│   │   └── websocket/
│   │       └── quotes_ws.py        # 行情WebSocket
│   ├── models/
│   │   ├── user.py
│   │   ├── symbol.py
│   │   ├── quote.py
│   │   ├── comment.py
│   │   └── topic.py
│   ├── schemas/                    # Pydantic模型
│   │   ├── user.py
│   │   ├── quote.py
│   │   └── comment.py
│   ├── services/
│   │   ├── auth_service.py
│   │   ├── quote_service.py
│   │   ├── comment_service.py
│   │   └── ranking_service.py      # 榜单计算服务
│   ├── tasks/
│   │   ├── quote_sync.py           # 行情数据同步任务
│   │   └── ranking_update.py       # 榜单更新任务
│   └── utils/
│       ├── security.py             # 安全工具
│       └── validators.py           # 校验器
├── migrations/                     # 数据库迁移 (Alembic)
├── tests/
├── requirements.txt
├── Dockerfile
└── docker-compose.yml
```

### 9.4 核心API设计

#### 9.4.1 API接口列表

**认证模块 `/api/v1/auth`**

| 方法 | 路径 | 说明 |
|-----|------|------|
| POST | /login/phone | 手机号验证码登录 |
| POST | /login/google | Google OAuth登录 |
| POST | /login/apple | Apple登录 |
| POST | /bind/wechat | 绑定微信 |
| DELETE | /bind/wechat | 解绑微信 |
| POST | /refresh | 刷新Token |

**行情模块 `/api/v1/quotes`**

| 方法 | 路径 | 说明 |
|-----|------|------|
| GET | /symbols | 获取品种列表 |
| GET | /symbols/{code} | 获取品种详情 |
| GET | /realtime | 获取实时行情（批量）|
| GET | /realtime/{code} | 获取单个品种实时行情 |
| GET | /kline/{code} | 获取K线数据 |
| WS | /ws/quotes | WebSocket实时行情订阅 |

**汇率模块 `/api/v1/exchange`**

| 方法 | 路径 | 说明 |
|-----|------|------|
| GET | /rates | 获取所有汇率 |
| GET | /convert | 货币换算 |

**评论模块 `/api/v1/comments`**

| 方法 | 路径 | 说明 |
|-----|------|------|
| GET | /{symbol_code} | 获取品种评论列表 |
| POST | / | 发布评论（含价格锚定）|
| POST | /{id}/reply | 回复评论 |
| POST | /{id}/like | 点赞评论 |
| DELETE | /{id}/like | 取消点赞 |
| DELETE | /{id} | 删除评论 |

**社区模块 `/api/v1/community`**

| 方法 | 路径 | 说明 |
|-----|------|------|
| GET | /topics/hot | 热门话题榜 |
| GET | /symbols/popular | 品种关注榜 |
| GET | /comments/top | 评论点赞榜 |

#### 9.4.2 核心接口示例

**发布评论（带价格锚定）**

```python
# POST /api/v1/comments
# Request
{
    "symbol_code": "XAUUSD",
    "content": "感觉要突破2660了，准备加仓！",
    "parent_id": null  # 如果是回复则填父评论ID
}

# Response
{
    "id": "comment_123456",
    "user": {
        "id": "user_789",
        "nickname": "投资达人A",
        "avatar": "https://..."
    },
    "symbol_code": "XAUUSD",
    "content": "感觉要突破2660了，准备加仓！",
    "price_at_comment": 2650.30,  # 系统自动记录的评论时价格
    "created_at": "2025-12-25T10:30:00Z",
    "likes_count": 0,
    "replies_count": 0
}
```

**WebSocket行情订阅**

```python
# 连接: ws://api.example.com/api/v1/ws/quotes

# 订阅消息
{
    "action": "subscribe",
    "symbols": ["XAUUSD", "XAGUSD", "USDCNY"]
}

# 行情推送
{
    "type": "quote",
    "data": {
        "symbol": "XAUUSD",
        "price": 2658.50,
        "change": 28.30,
        "change_percent": 1.08,
        "high": 2665.20,
        "low": 2630.00,
        "timestamp": "2025-12-25T10:30:05Z"
    }
}
```

### 9.5 数据库设计

#### 9.5.1 核心表结构

```sql
-- 用户表
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    phone VARCHAR(20) UNIQUE,
    nickname VARCHAR(50) NOT NULL,
    avatar VARCHAR(500),
    bio VARCHAR(200),
    google_id VARCHAR(100) UNIQUE,
    apple_id VARCHAR(100) UNIQUE,
    wechat_openid VARCHAR(100) UNIQUE,
    color_scheme VARCHAR(20) DEFAULT 'red_up',  -- red_up/green_up
    language VARCHAR(10) DEFAULT 'zh_CN',
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- 品种表
CREATE TABLE symbols (
    code VARCHAR(20) PRIMARY KEY,
    name_cn VARCHAR(50) NOT NULL,
    name_en VARCHAR(50) NOT NULL,
    market VARCHAR(20) NOT NULL,
    symbol_type VARCHAR(20) NOT NULL,
    base_currency VARCHAR(10),
    quote_currency VARCHAR(10),
    decimal_places INT DEFAULT 2,
    unit VARCHAR(20),
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    sort_order INT DEFAULT 0
);

-- 评论表
CREATE TABLE comments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    symbol_code VARCHAR(20) REFERENCES symbols(code),
    content TEXT NOT NULL,
    price_at_comment DECIMAL(20, 6) NOT NULL,  -- 关键：评论时价格
    parent_id UUID REFERENCES comments(id),
    likes_count INT DEFAULT 0,
    replies_count INT DEFAULT 0,
    is_deleted BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 评论点赞表
CREATE TABLE comment_likes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    comment_id UUID REFERENCES comments(id),
    user_id UUID REFERENCES users(id),
    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(comment_id, user_id)
);

-- 用户收藏品种表
CREATE TABLE user_favorites (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    symbol_code VARCHAR(20) REFERENCES symbols(code),
    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(user_id, symbol_code)
);

-- 话题表
CREATE TABLE topics (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL UNIQUE,
    description TEXT,
    discussion_count INT DEFAULT 0,
    heat_score INT DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### 9.6 部署架构

```
┌─────────────────────────────────────────────────────────────┐
│                    Cloud Provider (AWS/阿里云)               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐     ┌─────────────────────────────────┐   │
│  │   CDN       │────▶│  静态资源 (Flutter Web/Assets)   │   │
│  └─────────────┘     └─────────────────────────────────┘   │
│                                                             │
│  ┌─────────────┐     ┌─────────────────────────────────┐   │
│  │ Load Balancer│────▶│     Kubernetes / ECS            │   │
│  │  (ALB/SLB)  │     │  ┌───────────────────────────┐  │   │
│  └─────────────┘     │  │  FastAPI Pods (x3)        │  │   │
│                      │  └───────────────────────────┘  │   │
│                      │  ┌───────────────────────────┐  │   │
│                      │  │  WebSocket Pods (x2)      │  │   │
│                      │  └───────────────────────────┘  │   │
│                      │  ┌───────────────────────────┐  │   │
│                      │  │  Celery Workers (x2)      │  │   │
│                      │  └───────────────────────────┘  │   │
│                      └─────────────────────────────────┘   │
│                                     │                       │
│                      ┌──────────────┴──────────────┐       │
│                      ▼                             ▼       │
│            ┌─────────────────┐          ┌─────────────────┐│
│            │   PostgreSQL    │          │     Redis       ││
│            │   (RDS/主从)    │          │   (ElastiCache) ││
│            └─────────────────┘          └─────────────────┘│
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 10. 附录

### 10.1 名词解释

| 术语 | 解释 |
|------|------|
| 价格锚定 | 评论发布时自动记录并展示当时的实时价格 |
| K线图 | 金融市场常用的价格走势图表 |
| XAU/USD | 黄金兑美元的国际报价代码（伦敦金）|
| XAG/USD | 白银兑美元的国际报价代码（伦敦银）|
| SGE | 上海黄金交易所 (Shanghai Gold Exchange) |
| LBMA | 伦敦金银市场协会 (London Bullion Market Association) |
| COMEX | 纽约商品交易所 (Commodity Exchange) |
| T+D | 延期交收合约，支持保证金交易和双向操作 |
| Au99.99 | 上海黄金交易所实盘合约，黄金纯度不低于99.99% |
| SHAU | 上海金，人民币定价的黄金基准价格 |
| GC | COMEX黄金期货合约代码 |
| SI | COMEX白银期货合约代码 |

### 10.2 UI参考说明

根据需求描述：
- 首页UI布局：参考第一张截图（网格卡片布局，不含底部导航）
- 行情页UI布局：参考第二张截图（分类导航+列表，不含底部导航）
- 评论区布局：参考第三张截图（小红书风格评论列表）
- 评论对话逻辑：参考X(Twitter)的评论回复机制

### 10.3 竞品参考

- 英为财情（Investing.com）- 行情数据展示参考
- 金十数据 - 资讯展示参考
- 小红书 - 评论区UI布局参考
- X(Twitter) - 评论对话逻辑参考

---

**文档结束**

---

*本PRD由Claude基于产品经理最佳实践生成，如有疑问请与产品负责人确认。*